# DocumentSignBatchOperationWebExtension

Этот каталог содержит пример реализации групповой операции "Подписание документа".

## Настройка среды

Пример рассчитан на версию Web-клиента 18 (6.1) или выше.

**Перечень необходимых инструментов:** 
* [NodeJS v16.20.0+](https://nodejs.org/en/)

## Сборка и установка

1. Открыть консоль в папке DocumentSignBatchOperationWebExtension и выполнить команду npm install, потом  npm update и в конце npm run build:prod
2. Скопировать каталог SamplesOutput\Site\Content\Modules\DocumentSignBatchOperationWebExtension в каталог "Путь к сайту Web-клиента\Content\Modules"
3. Скопировать файл расширения Конструктора веб-разметок из папки DocumentSignBatchOperationDesignerExtension в папку "Путь к директории с исполняемым файлом конструктора Web-разметок\Plugins". 
4. Перезапустить Web-сервис

## Проверка примера

1. Запустить конструктор разметок.
2. Импортировать решение из файла DocumentSignBatchOperation.xml.
3. Сделать решение DocumentSignBatchOperation активным для локации Папка. Проверить, что в контроле FolderGridBatchOperationsNode разметки присутсвует дочерний контрол DocumentSignBatchOperation.
4. Перезапустить Web-сервис.
5. Открыть Справочник сотрудников в Веб-клиенте, назначить пользователю, которым планируется подписание, сертификат по умолчанию.
6. Открыть пользователем из п.6 Веб-клиент. Убедиться на любой тестовой карточке документа, что подписание сертификатом из п.6 проходит корректно.
7. Открыть папку с документами в представлении Дайджест. Выделить при помощи чекбоксов документы для подписания. На панели групповых операций нажать кнопку "Подписать документ".
8. При необходимости просмотреть подписывемые документы, кликая на ссылки карточек в открывшемся окне подтверждения. Нажать OK.
9. Проверить на нескольких документах, что подписание прошло корректно.

При необходимости работы с другим представлением для корректного отображения ссылок на карточки требуется настроить свойство "Столбцы представления для презентации" контрола DocumentSignBatchOperation в Конструкторе разметок. Следует через запятую указать columnName столбцов предствления, выбранных для отображения.

Внимание! Если в выбор документов в таблице попадет документ, не доступный для подписания по состоянию или настройкам, будет выведено сообщение об ошибке, и подписания документа не произойдет. Для остальных документов процесс подписания будет продолжен.

## Проект DocumentSignBatchOperationWebExtension

Проект-расширение клиентской части Web-клиент. Содержит контрол групповой операции Подписание документа.
